# 批量视频编码工具 (Batch Video Encoder)

基于 PyQt5 和 FFmpeg 的批量视频编码工具，支持拖放、批量处理、保留目录结构、多语言界面等功能。
提示：此项目使用 AI 并在作者监督下完成，完全基于作者的个人需求开发，可以提需求但不一定采纳。

[English README](docs/readme_en.md)

## ✨ 功能特性

- ✅ **图形化界面**：基于 PyQt5 的现代化界面
- ✅ **拖放支持**：支持单个文件和整个文件夹拖放
- ✅ **批量编码**：支持多种视频格式（mp4/flv/webm/rm/rmvb/wmv/mov 等）
- ✅ **统一输出**：所有输出统一为 `.mp4` 格式
- ✅ **目录结构保留**：自动保留原始目录结构
- ✅ **任务状态管理**：等待编码、正在编码、编码完成、编码失败、挂起
- ✅ **实时进度显示**：整体进度和单文件进度，Windows 任务栏进度指示器
- ✅ **多语言支持**：简体中文、繁体中文、英语、日语
- ✅ **文件信息加载**：大量文件时显示加载进度对话框
- ✅ **右键菜单**：打开源文件、定位文件目录、修改任务状态
- ✅ **提示音通知**：队列完成后可播放自定义提示音
- ✅ **配置记忆**：自动保存窗口大小、编码参数、最后使用的目录等

## 🚀 快速开始

### 环境要求

- Python 3.8 或更高版本
- FFmpeg（已安装到系统 PATH 或在设置中指定路径）

### 安装步骤

1. **克隆仓库**
   ```bash
   git clone https://github.com/vevan/VvEnc.git
   cd VvEnc
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python main.py
   ```

## 📖 使用说明

### 基本使用流程

1. **启动程序**：运行 `python main.py`
2. **添加文件**：
   - 点击"添加文件"或"添加文件夹"按钮
   - 或直接将文件/文件夹拖放到窗口
3. **配置参数**：点击"设置"按钮配置编码参数
4. **选择输出目录**：点击"选择输出目录"按钮
5. **开始编码**：点击"开始编码"按钮

### 主要功能

- **批量编码**：支持拖入多个文件或整个文件夹进行批量编码
- **统一输出 `.mp4`**：无论输入格式，输出一律为 `.mp4`
- **目录结构保留**：拖入目录 `A` 输出到目录 `B` 时，自动生成 `B/A/...` 结构
- **任务状态管理**：
  - 状态：等待编码、正在编码、编码完成、编码失败、挂起
  - 已完成/失败/挂起的文件会在下一次编码时自动跳过
  - 可通过右键菜单修改文件状态
- **多语言界面**：支持简体中文、繁体中文、英语、日语切换

## 📚 详细文档

- [📘 使用说明（中文）](docs/usage_cn.md) - 详细的使用指南和功能介绍
- [📗 Usage Guide (English)](docs/usage_en.md) - Detailed usage instructions
- [📦 打包说明](docs/package.md) - 如何打包成独立可执行文件
- [📦 Building Executable](docs/package_en.md) - How to build standalone executable
- [🚀 GitHub Actions 自动打包](docs/github_actions.md) - 使用 GitHub Actions 自动构建
- [🚀 GitHub Actions Auto Build](docs/github_actions_en.md) - Auto build with GitHub Actions

## ⚙️ 配置说明

程序会自动保存配置到 `config.json`，包括：

- **FFmpeg 路径**：如果 FFmpeg 不在系统 PATH 中，可手动指定
- **编码参数**：视频编码器、CRF、预设、分辨率、位深等
- **音频参数**：音频编码器、码率、备用音频编码参数
- **窗口设置**：窗口大小、表格列宽和顺序
- **其他设置**：语言、提示音、最后使用的目录等

## 🔐 关于代码签名与安全提示

- 当前项目发布的 Windows/macOS 可执行文件 **未进行代码签名**，属于“未知发布者”程序。
- 在 Windows 上首次运行时，可能会触发 **SmartScreen 提示**（例如“Windows 已保护你的电脑”）：
  - 请确认你是从本项目的官方发布页面获取的程序；
  - 点击“更多信息”→“仍要运行”即可继续。
- 本项目完全开源，源代码可在 GitHub 上自由查看和自行构建，如有安全疑虑，建议自行从源码编译后使用。

## 🛠️ 打包成可执行文件

使用 `build_exe.bat` 可以将程序打包成独立的 Windows 可执行文件：

```bash
build_exe.bat
```

打包完成后，可执行文件位于 `dist\VvEnc.exe`。

详细说明请查看 [打包说明](docs/打包说明.md)。

## 🎯 主要特性详解

### 任务状态管理

- **等待编码**（浅黄）：新添加的文件，等待处理
- **正在编码**（浅蓝）：当前正在编码的文件
- **编码完成**（浅绿）：编码成功的文件
- **编码失败**（浅红）：编码失败的文件
- **挂起**（浅紫）：手动设置为挂起，后续会被跳过

### 编码参数配置

- **视频编码器**：libx264、libx265、NVENC、AV1 等
- **CRF 质量**：控制输出质量（推荐 18-28）
- **编码预设**：控制编码速度（ultrafast 到 veryslow）
- **分辨率**：可指定输出分辨率（留空保持原分辨率）
- **位深**：8 位或 10 位
- **音频编码**：copy、aac、mp3、opus 等
- **备用音频编码**：当 copy 不适合 MP4 容器时自动使用

### 高级功能

- **Windows 任务栏进度**：编码时在任务栏图标上显示进度条
- **加载进度对话框**：添加大量文件时显示加载进度
- **右键菜单**：
  - 打开源文件：使用系统默认程序打开
  - 定位文件目录：在文件管理器中打开并选中文件
  - 修改任务状态：设为等待编码或挂起
- **提示音通知**：队列完成后可播放自定义音频文件

## 📝 更新日志

查看 [CHANGELOG.md](CHANGELOG.md)（如果存在）了解版本更新历史。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

本项目采用 **GNU 通用公共许可证（GPL）** 授权。

- 你可以自由地使用、学习、修改和分发本项目，但分发的衍生作品也必须遵循 GPL 协议；
- 详细条款请参考仓库根目录中的 [LICENSES](LICENSES) 文件或 GNU 官网。

## 🔗 相关链接

- [FFmpeg 官网](https://ffmpeg.org/)
- [PyQt5 文档](https://www.riverbankcomputing.com/static/Docs/PyQt5/)
- [GNU 官网（GPL 协议）](https://www.gnu.org/licenses/gpl-3.0.html)

---

**注意**：使用本工具需要系统已安装 FFmpeg。如果 FFmpeg 不在系统 PATH 中，请在程序设置中手动指定 FFmpeg 的完整路径。
